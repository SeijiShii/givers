# UX モック磨きフェーズ 提案書

**前提**: サーバー実装を凍結し、フロントエンドモックを磨き上げる。寄付による応援プラットフォーム GIVErS を**軽量SNSの方向性**で検討する。

---

## 1. 基盤: API モック層の導入

**目的**: バックエンドなしでフロントエンドを完結させる。UX検証・デザイン検討を自由に行えるようにする。

### 1.1 実装方針

| 方式 | メリット | デメリット |
|------|----------|------------|
| **環境変数で切り替え** | シンプル、既存コード変更少 | 切り替え時に再ビルド |
| **MSW (Mock Service Worker)** | ネットワーク層でインターセプト、本番に近い | セットアップ手間 |
| **api.ts の抽象化** | 最小変更、モック実装を差し替え | テストと本番で別経路 |

**推奨**: `api.ts` に `MOCK_MODE` を導入し、モック実装を差し替える方式。シンプルで即効性がある。

```ts
// src/lib/api.ts の先頭で
const MOCK_MODE = import.meta.env.PUBLIC_MOCK_MODE === 'true';

// getProjects などで
if (MOCK_MODE) return mockApi.getProjects(limit, offset);
```

### 1.2 モックデータの充実

- **プロジェクト**: 5〜10件の多様なサンプル（達成率 20% / 50% / 90% / 100% 超など）
- **ユーザー**: ログイン済み/未ログインの切り替え可能
- **寄付履歴**: マイページ用のサンプル（Phase 4 前提だがモックで先行）
- **ホスト健全性**: 青/黄/赤の各状態を切り替え可能

---

## 2. 軽量SNS の UX 要素（提案）

GIVErS を「寄付プラットフォーム」から「応援のつながりを感じる軽量SNS」へ。以下の要素をモックで検証する。

### 2.1 アクティビティフィード（タイムライン）

| 項目 | 内容 |
|------|------|
| **場所** | トップページ、または専用 `/feed` |
| **表示内容** | ・新規プロジェクト登録<br>・プロジェクトの更新・マイルストーン<br>・「〇〇さんが △△ を応援しました」（匿名可）<br>・達成率の節目（50%到達など） |
| **SNSらしさ** | 時系列で「いま起きていること」を感じられる |

**モックでやること**: 静的/擬似データでフィードUIを実装し、情報の粒度・表示順・匿名表示のバランスを検証。

### 2.2 プロジェクトの「顔」を出す

| 項目 | 内容 |
|------|------|
| **オーナー表示** | プロジェクトカード・詳細にオーナー名・アバター（モック） |
| **感謝の表示** | 「最近の応援者」（匿名可）をプロジェクト詳細に表示 |
| **更新ノート** | プロジェクトの近況を短く投稿（Phase 5 以降の機能だがモックで先行） |

**軽量SNSの核心**: 「誰が」「何を」やっているかが一目でわかる。

### 2.3 発見・つながりの導線

| 項目 | 内容 |
|------|------|
| **関連プロジェクト** | プロジェクト詳細に「このプロジェクトを応援している人はこちらも」 |
| **新着 / HOT** | トップに新着・人気プロジェクト（実装プラン Phase 5 の先行モック） |
| **タグ・カテゴリ** | 技術系 / アート / 教育 など、フィルタ用のモック |

**idea.md の思想**: 「プロジェクトページから他のプロジェクトにも遷移できる。発見のきっかけを提供する」を具体化。

### 2.4 寄付体験の UX（モック先行）

| 項目 | 内容 |
|------|------|
| **寄付フォーム** | 金額選択（¥500 / ¥1,000 / 任意）、メッセージ欄（任意）のUI |
| **寄付完了画面** | サンクス表示、プロジェクトオーナーへのメッセージ表示（モック） |
| **匿名寄付→アカウント移行** | 「これまでの寄付をアカウントに引き継ぎますか？」のフローをモックで体験 |

**Phase 4 実装前に**: 寄付の心理的ハードルを下げるUIを検証。

### 2.5 ウォッチ / フォロー（軽量版）

| 項目 | 内容 |
|------|------|
| **ウォッチボタン** | プロジェクト詳細に「ウォッチする」（ハートやベルアイコン） |
| **ウォッチ一覧** | マイページに「ウォッチ中のプロジェクト」 |
| **通知** | ウォッチ中プロジェクトの更新時に（将来）通知。モックでは「通知あり」の表示のみ |

**軽量SNSの核**: フォロー関係が薄くても「気になる」を残せる。

---

## 3. ビジュアル・インタラクションの磨き

### 3.1 デザインシステムの統一

- **草原テーマ**（既存 `global.css`）をベースに、コンポーネントごとの一貫性を確認
- **カード・ボタン・フォーム**のスタイルを `components/` で再利用可能に
- **ダークモード**（任意）: CSS 変数で切り替え可能にしておくと将来楽

### 3.2 ローディング・スケルトン

- プロジェクト一覧: カード型のスケルトン
- プロジェクト詳細: テキスト・達成率バーのスケルトン
- 寄付フォーム: ボタンのローディング状態

**UX**: 白画面より「読み込み中」が伝わる方が安心感がある。

### 3.3 マイクロインタラクション

- カードホバー時の軽い浮き上がり（既存 `box-shadow` を強化）
- 達成率バーのアニメーション（0%→実際の値へ）
- 寄付ボタンクリック時のフィードバック

### 3.4 レスポンシブ

- ナビゲーション: モバイルでハンバーガーメニュー
- プロジェクトカード: 1列→2列のグリッド
- 寄付フォーム: モバイルでタップしやすいボタンサイズ

---

## 4. オンボーディング・初回体験

### 4.1 初回訪問者向け

- トップのヒーローで「GIVE の精神」を一言で伝える（既存を強化）
- 「はじめての方へ」または「使い方」の短い導線
- プロジェクト一覧が空のときの「最初のプロジェクトを作る」CTA

### 4.2 寄付までの導線

- プロジェクト詳細から寄付フォームまでのクリック数を最小化
- 「匿名で寄付」「アカウント作成して継続支援」の選択を明確に

---

## 5. 実装優先度（提案）

| 優先度 | 項目 | 工数目安 | 効果 |
|--------|------|----------|------|
| **P0** | API モック層 + 豊富なモックデータ | 0.5〜1日 | サーバーなしで全ページ動作 |
| **P0** | トップページの新着・HOT 表示（モック） | 0.5日 | 発見体験の検証 |
| **P1** | アクティビティフィード（簡易版） | 1日 | 軽量SNSの核 |
| **P1** | プロジェクトカードのオーナー表示・感謝表示 | 0.5日 | 「顔」の可視化 |
| **P1** | 寄付フォームのモックUI | 0.5日 | 寄付体験の検証 |
| **P2** | ローディング・スケルトン | 0.5日 | 体感品質向上 |
| **P2** | 関連プロジェクト表示 | 0.5日 | 発見導線 |
| **P2** | ウォッチボタン・一覧（モック） | 0.5日 | 軽量SNSのつながり |
| **P3** | レスポンシブ強化 | 1日 | モバイル対応 |
| **P3** | マイクロインタラクション | 0.5日 | 仕上がり感 |

---

## 6. 成果物イメージ

- **docs/ux-mock-phase-proposal.md**（本ドキュメント）
- **frontend/src/lib/mock-api.ts** … モック実装
- **frontend/src/data/mock-projects.json** … サンプルデータ（任意）
- 環境変数 `PUBLIC_MOCK_MODE=true` でモックモード起動

---

## 7. 次のアクション

1. **P0 から着手**: モック層導入 → トップの新着/HOT
2. **週1回程度**: モックで実際に操作し、UX の違和感をメモ
3. **サーバー再開時**: モックを外し、API に差し替え。UX で固めた導線はそのまま活かす

---

## 8. P0 実装済み（2025-02）

| 項目 | 実装内容 |
|------|----------|
| API モック層 | `src/lib/mock-api.ts`、`src/data/mock-projects.ts` |
| モック切り替え | `PUBLIC_MOCK_MODE=true` で有効（`frontend/.env`） |
| モックデータ | 6件のプロジェクト（達成率 27%〜119%） |
| トップ新着/HOT | `FeaturedProjects` コンポーネント、新着・人気の2カラム |
| 達成率表示 | `Project.current_monthly_donations` でモック時に表示 |

### 起動方法

```bash
cd frontend
# .env に PUBLIC_MOCK_MODE=true を設定済み
npm run dev
# http://localhost:4321 でサーバーなしで全ページ動作
```

### モック解除

`frontend/.env` で `PUBLIC_MOCK_MODE=false` に変更し、バックエンドを起動する。

---

## 9. P1 実装済み（2025-02）

| 項目 | 実装内容 |
|------|----------|
| アクティビティフィード | `ActivityFeed` コンポーネント、トップに「いま起きていること」 |
| オーナー表示 | プロジェクトカード・詳細に「by オーナー名」 |
| 感謝表示 | プロジェクト詳細に「最近の応援者」リスト（匿名可） |
| 寄付フォーム | `DonateForm`、金額選択（¥300〜¥5,000 + 任意額）、メッセージ欄、サンクス表示 |

---

## 10. P2 実装済み（2025-02）

| 項目 | 実装内容 |
|------|----------|
| チャート | `ProjectChart`（Recharts）、最低金額・目標金額・達成額の折れ線グラフ |
| ホスト・プラットフォームプロジェクト | 「GIVErS への寄付」専用ページ、プロジェクト一覧でのバッジ、双方向リンク |

**詳細**: `docs/mock-implementation-status.md` にモック実装の検討・実装状況を文書化

---

## 11. 今後の UX 変更予定（TODO 10〜12）

### 11.1 ホスト自身の利用停止禁止（TODO 10）

| 項目 | 内容 |
|------|------|
| **バックエンド** | `PATCH /api/admin/users/:id/suspend` で対象が自分自身の場合は 400 エラー |
| **フロント** | ユーザー管理一覧 (`/admin/users`) で自分の行の「利用停止」ボタンを非表示 or disabled |

### 11.2 description と overview の統合（TODO 11）

現状 `description`（カード用短文）と `overview`（詳細ページ Markdown）が別カラム。
`overview` 1 カラムに統合し、新規作成時から Markdown で書けるようにする。

| 変更箇所 | 内容 |
|----------|------|
| **DB** | `overview` カラムに統合。`description` は廃止 or エイリアス化 |
| **新規プロジェクトフォーム** | 「説明」入力欄を Markdown 対応に変更。プレースホルダーに記法案内。「後から編集できます」注記 |
| **プロジェクト編集フォーム** | 同様に Markdown 対応 |
| **プロジェクト詳細ページ** | 現状の Overview タブと統合（変更なし or タブ構成見直し） |
| **プロジェクト一覧カード** | `overview` の先頭 N 文字を表示（Markdown ストリップ） |
| **API** | `POST`/`PUT /api/projects` で `overview` を受け取る。`description` は後方互換で残すか検討 |

### 11.3 コスト内訳 UI を自由入力に変更（TODO 12）

API は `cost_items`（ラベル・金額の行リスト）で自由入力対応済みだが、
UI がサーバー費/開発費/その他の固定 3 項目のまま。API に合わせる。

| 変更箇所 | 内容 |
|----------|------|
| **新規プロジェクトフォーム** | 固定 3 項目 → 動的行追加 UI。各行: ラベル（自由入力）+ 金額タイプ（月額/日額×日数）+ 金額入力。「＋ 項目を追加」ボタン + 各行に削除ボタン |
| **プロジェクト編集フォーム** | 同様に動的行 UI |
| **コストプリセット連携** | `cost_presets` API と連携し、よく使う項目をワンクリック追加 |
| **プロジェクト詳細ページ** | `cost_items` を個別表示（現状の `costs` 固定表示を置き換え） |
| **フロント型定義** | `ProjectCosts`（固定 3 項目）→ `ProjectCostItem[]`（動的）に移行 |

詳細な API 仕様・DB マイグレーション・UX フローは `docs/cost-items-plan.md` を参照。
